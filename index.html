<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NOUR NADY - ููุญุฉ ุชุญูู ุงููุดุฑู</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&amp;display=swap" rel="stylesheet">
  <style>
    body { box-sizing: border-box; }
    * { font-family: 'Cairo', sans-serif; }
    .gradient-bg { background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%); }
    .card-glass { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
    .btn-primary { background: linear-gradient(135deg, #00d4ff 0%, #0099ff 100%); }
    .btn-secondary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .input-style { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; }
    .stat-card { background: linear-gradient(135deg, rgba(0,212,255,0.1), rgba(0,153,255,0.1)); border: 1px solid rgba(0,212,255,0.3); }
    .stat-number { color: #00d4ff; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .animate-fade { animation: fadeIn 0.5s ease-out; }
  </style>
 </head>
 <body class="h-full gradient-bg text-white overflow-auto">
  <div id="app" class="min-h-full w-full">
   <div id="loading-screen" class="fixed inset-0 gradient-bg flex items-center justify-center z-50">
    <div class="text-center">
     <div class="w-16 h-16 border-4 border-t-cyan-400 border-r-transparent border-b-cyan-400 border-l-transparent rounded-full animate-spin mx-auto mb-4"></div>
     <p class="text-xl">ุฌุงุฑู ุงูุชุญููู...</p>
    </div>
   </div>

   <div id="login-page" class="hidden min-h-full w-full p-4">
    <div class="max-w-md mx-auto pt-20 animate-fade">
     <div class="text-center mb-8">
      <h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500 mb-2">NOUR NADY</h1>
      <p class="text-gray-400">ููุญุฉ ุชุญูู ุงููุดุฑู</p>
     </div>
     <div class="card-glass rounded-2xl p-8">
      <form id="admin-login-form" onsubmit="handleAdminLogin(event)">
       <div class="mb-4"><label class="block mb-2 text-gray-300">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label> <input type="email" id="admin-email-input" class="w-full p-4 rounded-xl input-style" value="noornady00@gmail.com" required></div>
       <div class="mb-6"><label class="block mb-2 text-gray-300">ูููุฉ ุงูุณุฑ</label> <input type="password" id="admin-password-input" class="w-full p-4 rounded-xl input-style" value="noornady2007" required></div>
       <button type="submit" class="w-full py-4 rounded-xl btn-primary text-white font-bold text-lg">ุฏุฎูู</button>
       <p id="login-error" class="text-red-400 text-center mt-4 hidden"></p>
      </form>
     </div>
    </div>
   </div>

   <div id="dashboard" class="hidden min-h-full w-full">
    <header class="card-glass p-4 sticky top-0 z-40 shadow-lg">
     <div class="max-w-7xl mx-auto flex justify-between items-center">
      <h1 class="text-2xl font-black text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">ููุญุฉ ุงูุชุญูู</h1>
      <button onclick="logoutAdmin()" class="bg-red-500/20 text-red-400 px-4 py-2 rounded-xl hover:bg-red-500/30 font-bold">ุฎุฑูุฌ</button>
     </div>
    </header>

    <nav class="max-w-7xl mx-auto p-4">
     <div class="flex gap-2 flex-wrap">
      <button onclick="showAdminSection('overview')" class="admin-nav-btn px-6 py-3 rounded-xl btn-primary text-white font-bold" data-section="overview">๐ ูุธุฑุฉ ุนุงูุฉ</button>
      <button onclick="showAdminSection('courses')" class="admin-nav-btn px-6 py-3 rounded-xl card-glass text-gray-300 font-bold" data-section="courses">๐ ุงูููุฑุณุงุช</button>
      <button onclick="showAdminSection('exams')" class="admin-nav-btn px-6 py-3 rounded-xl card-glass text-gray-300 font-bold" data-section="exams">๐ ุงูุงูุชุญุงูุงุช</button>
      <button onclick="showAdminSection('students')" class="admin-nav-btn px-6 py-3 rounded-xl card-glass text-gray-300 font-bold" data-section="students">๐ฅ ุงูุทูุงุจ</button>
     </div>
    </nav>

    <main class="max-w-7xl mx-auto p-4">
     <section id="overview-section" class="section animate-fade">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
       <div class="stat-card rounded-xl p-6 text-center"><p class="text-gray-400 mb-2">ุฅุฌูุงูู ุงูุทูุงุจ</p><p class="stat-number text-4xl font-black" id="total-students">0</p></div>
       <div class="stat-card rounded-xl p-6 text-center"><p class="text-gray-400 mb-2">ุงูููุฑุณุงุช</p><p class="stat-number text-4xl font-black" id="total-courses">0</p></div>
       <div class="stat-card rounded-xl p-6 text-center"><p class="text-gray-400 mb-2">ุงูุงูุชุญุงูุงุช</p><p class="stat-number text-4xl font-black" id="total-exams">0</p></div>
      </div>
     </section>

     <section id="courses-section" class="section hidden animate-fade">
      <div class="flex justify-between items-center mb-6"><h2 class="text-2xl font-bold">๐ ุฅุฏุงุฑุฉ ุงูููุฑุณุงุช</h2><button onclick="openModal('add-course-modal')" class="btn-secondary px-6 py-3 rounded-xl text-white font-bold">+ ุฅุถุงูุฉ ููุฑุณ ุฌุฏูุฏ</button></div>
      <div id="courses-list" class="space-y-4"></div>
     </section>

     <section id="exams-section" class="section hidden animate-fade">
      <div class="flex justify-between items-center mb-6"><h2 class="text-2xl font-bold">๐ ุฅุฏุงุฑุฉ ุงูุงูุชุญุงูุงุช</h2><button onclick="openModal('add-exam-modal')" class="btn-secondary px-6 py-3 rounded-xl text-white font-bold">+ ุฅุถุงูุฉ ุงูุชุญุงู ุฌุฏูุฏ</button></div>
      <div id="exams-list" class="space-y-4"></div>
     </section>

     <section id="students-section" class="section hidden animate-fade">
      <h2 class="text-2xl font-bold mb-6">๐ฅ ุทูุจุงุช ุงูุทูุงุจ ุงูุฌุฏุฏ</h2>
      <div id="pending-students-list" class="space-y-3"></div>
      <h2 class="text-2xl font-bold my-6 text-green-400">โ ุงูุทูุงุจ ุงููุนุชูุฏูู</h2>
      <div id="approved-students-list" class="space-y-3"></div>
     </section>
    </main>
   </div>

   <div id="add-course-modal" class="hidden fixed inset-0 bg-black/90 z-50 overflow-auto p-4">
    <div class="max-w-2xl mx-auto my-8 card-glass rounded-2xl p-6">
      <div class="flex justify-between items-center mb-6"><h3 class="text-2xl font-bold">ุฅุถุงูุฉ ููุฑุณ ุฌุฏูุฏ</h3><button onclick="closeModal('add-course-modal')" class="text-white text-3xl">ร</button></div>
      <form onsubmit="handleAddCourse(event)">
       <div class="mb-4"><label class="block mb-2">ุงุณู ุงูููุฑุณ</label><input type="text" id="course-name" class="w-full p-3 rounded-lg input-style" required></div>
       <div class="mb-4"><label class="block mb-2">ุงูุตู ุงูุฏุฑุงุณู</label>
        <select id="course-grade" class="w-full p-3 rounded-lg input-style" required>
         <option value="prep1">ุฃููู ุฅุนุฏุงุฏู</option><option value="prep2">ุชุงููุฉ ุฅุนุฏุงุฏู</option><option value="prep3">ุชุงูุชุฉ ุฅุนุฏุงุฏู</option>
         <option value="sec1">ุฃููู ุซุงููู</option><option value="sec2">ุชุงููุฉ ุซุงููู</option><option value="sec3">ุชุงูุชุฉ ุซุงููู</option>
        </select>
       </div>
       <div class="mb-6"><label class="block mb-2">ุฑุงุจุท ุงูููุฏูู (YouTube)</label><input type="url" id="course-url" class="w-full p-3 rounded-lg input-style" required></div>
       <button type="submit" class="w-full py-3 rounded-lg btn-primary text-white font-bold">ุญูุธ ุงูููุฑุณ</button>
      </form>
    </div>
   </div>

   <div id="add-exam-modal" class="hidden fixed inset-0 bg-black/90 z-50 overflow-auto p-4">
    <div class="max-w-2xl mx-auto my-8 card-glass rounded-2xl p-6">
      <div class="flex justify-between items-center mb-6"><h3 class="text-2xl font-bold">ุฅุถุงูุฉ ุงูุชุญุงู</h3><button onclick="closeModal('add-exam-modal')" class="text-white text-3xl">ร</button></div>
      <form onsubmit="handleAddExam(event)">
       <div class="mb-4"><label class="block mb-2">ุงุณู ุงูุงูุชุญุงู</label><input type="text" id="exam-name" class="w-full p-3 rounded-lg input-style" required></div>
       <div class="mb-4"><label class="block mb-2">ุงูุตู ุงูุฏุฑุงุณู</label>
        <select id="exam-grade" class="w-full p-3 rounded-lg input-style" required>
         <option value="prep1">ุฃููู ุฅุนุฏุงุฏู</option><option value="prep2">ุชุงููุฉ ุฅุนุฏุงุฏู</option><option value="prep3">ุชุงูุชุฉ ุฅุนุฏุงุฏู</option>
        </select>
       </div>
       <button type="submit" class="w-full py-3 rounded-lg btn-primary text-white font-bold">ุฅูุดุงุก ุงูุงูุชุญุงู</button>
      </form>
    </div>
   </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC9xegXKAHeaDsbh0EERWnWqJI4iaxvJW8",
      authDomain: "noornady.firebaseapp.com",
      projectId: "noornady",
      storageBucket: "noornady.firebasestorage.app",
      messagingSenderId: "426364363200",
      appId: "1:426364363200:web:2783bf7fca67a579e86825"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    let allData = [];

    // Sync Data
    onSnapshot(collection(db, "platform_data"), (snapshot) => {
      allData = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
      updateUI();
      document.getElementById('loading-screen').classList.add('hidden');
    });

    window.handleAdminLogin = (e) => {
      e.preventDefault();
      const email = document.getElementById('admin-email-input').value;
      const pass = document.getElementById('admin-password-input').value;
      if(email === "noornady00@gmail.com" && pass === "noornady2007") {
        document.getElementById('login-page').classList.add('hidden');
        document.getElementById('dashboard').classList.remove('hidden');
      } else { alert("ุจูุงูุงุช ุฎุงุทุฆุฉ"); }
    };

    window.showAdminSection = (id) => {
      document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
      document.getElementById(id + '-section').classList.remove('hidden');
    };

    function updateUI() {
      const students = allData.filter(d => d.type === 'student');
      const courses = allData.filter(d => d.type === 'course');
      const exams = allData.filter(d => d.type === 'exam');

      document.getElementById('total-students').textContent = students.length;
      document.getElementById('total-courses').textContent = courses.length;
      document.getElementById('total-exams').textContent = exams.length;

      // Render Pending Students
      document.getElementById('pending-students-list').innerHTML = students.filter(s => s.status === 'pending').map(s => `
        <div class="p-4 card-glass rounded-xl flex justify-between items-center">
          <div><p class="font-bold">${s.name}</p><p class="text-sm text-gray-400">${s.phone} | ${s.grade}</p></div>
          <button onclick="approveStudent('${s.id}')" class="bg-green-500 px-4 py-2 rounded-lg text-sm">ุงุนุชูุงุฏ</button>
        </div>
      `).join('') || '<p class="text-center text-gray-500">ูุง ููุฌุฏ ุทูุจุงุช</p>';

      // Render Approved Students
      document.getElementById('approved-students-list').innerHTML = students.filter(s => s.status === 'approved').map(s => `
        <div class="p-3 card-glass rounded-xl text-sm border-r-4 border-green-500">${s.name} - ${s.phone}</div>
      `).join('');

      // Render Courses
      document.getElementById('courses-list').innerHTML = courses.map(c => `
        <div class="p-4 card-glass rounded-xl flex justify-between">
          <span>${c.name} (${c.grade})</span>
          <button onclick="deleteDocById('${c.id}')" class="text-red-400">ุญุฐู</button>
        </div>
      `).join('');
    }

    window.approveStudent = async (id) => { await updateDoc(doc(db, "platform_data", id), { status: 'approved' }); };
    window.deleteDocById = async (id) => { await deleteDoc(doc(db, "platform_data", id)); };

    window.handleAddCourse = async (e) => {
      e.preventDefault();
      await addDoc(collection(db, "platform_data"), {
        type: 'course',
        name: document.getElementById('course-name').value,
        grade: document.getElementById('course-grade').value,
        url: document.getElementById('course-url').value,
        createdAt: Date.now()
      });
      closeModal('add-course-modal');
    };

    window.handleAddExam = async (e) => {
      e.preventDefault();
      await addDoc(collection(db, "platform_data"), {
        type: 'exam',
        name: document.getElementById('exam-name').value,
        grade: document.getElementById('exam-grade').value,
        questions: [], // ูุจุฏุฆูุงู
        createdAt: Date.now()
      });
      closeModal('add-exam-modal');
    };

    window.openModal = (id) => document.getElementById(id).classList.remove('hidden');
    window.closeModal = (id) => document.getElementById(id).classList.add('hidden');
    window.logoutAdmin = () => location.reload();

    document.getElementById('login-page').classList.remove('hidden');
  </script>
 </body>
</html>
